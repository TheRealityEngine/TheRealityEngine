<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>

      .column {
        float: left;
        min-width:20em;
        padding: 10px;
        box-sizing:border-box;
        width: 48%
      }
      @media only screen and (max-width: 48em) {
        .column { width: 100%; }
      }
      .row:after {
        content: "";
        display: table-row;
        clear: both;
      }
      input.attrib {
        width: 30px;
      }
      .num,
      .dots {
        display: inline;
      }

      table,
      td,
      th {
        border: 1px solid black;
      }

      table {
        border-collapse: collapse;
        width: 90%;
      }

      td {
        padding: 4px;
        text-align: left;
      }

      
      h1 {
        text-align: center;
      }
      h2 {
        text-align: center;
      }
      p.res {
        text-align: center;
      }
      .aDot,
      .aCir,
      .aBox,
      .fBox {
        width: 1.4em;
        height: 1.4em;
      }
      .stat {
        font-size: 1.4em;
      }
      .tiny {
        font-size: .6em;
      }

      .title {
        display: inline;
        border: 1px solid black;
        border-top-left-radius: 5px;
        border-top-right-radius: 5px;
        border-bottom: none;
      }
    </style>
  </head>
  <body>
    <div>
    <h2 id="spellTitle" style="background-color:whitesmoke; color: gray" class="title" onclick="ToggleBox('abilityColumn', 'spellColumn')">Spell Casting</h2>
      <h2 id="abilityTitle" style="background-color:white" class="title" onclick="ToggleBox('spellColumn', 'abilityColumn')">Attributes & Skills</h2>
    </div>
    <div class="casting" >
    <div class="row">
      
      <div id="spellColumn" class="column" style="display:none;">
        
        <p class="stat" name="gno">
          <input
            type="number"
            min="1"
            max="5"
            value="1"
            id="gnonum"
            class="attrib"
            name="Gnosis"
            oninput="NumberMe('gno')"
            
          />
          <b><span onclick="GimmeInfo('gnosis')">Gnosis</span></b>
          <span id="gnoPar">What?</span>
        </p>

        <p class="stat" name="arc">
          <input
            type="number"
            min="1"
            max="5"
            value="1"
            id="arcnum"
            class="attrib"
            oninput="NumberMe('arc')"
          />
          <b><span onclick="GimmeInfo('arcana')">Arcana Level</span></b>
          <span id="arcPar">What?</span>
        </p>
        <p class="stat" name="spe">
          <input
            type="number"
            min="1"
            value="1"
            id="spenum"
            class="attrib"
            oninput="NumberMe('spe')"
          />
          <b><span onclick="GimmeInfo('spell')">Spell Level</span></b>
          <span id="spePar">What?</span>
        </p>
        <p id="spLvl"></p>
        <form>
          <br />
          <h2><span onclick="GimmeInfo('reach')">Reach</span></h2>
          <p id="freeReach">Free Reach: 1</p>
          <table>
            <tr>
              <th>Type</th>
              <th>Basic</th>
              <th>Advanced</th>
            </tr>
            <tr>
              <td>Casting Time</td>
              <td>
                <input
                  type="radio"
                  name="castingtime"
                  value="0"
                  checked="true"
                />Ritual (10 mins/dot)
              </td>
              <td><input type="radio" name="castingtime" value="1" />1 Turn</td>
            </tr>
            <tr>
              <td>Duration</td>
              <td>
                <input
                  type="radio"
                  name="duration"
                  value="0"
                  checked="true"
                />Turn
              </td>
              <td><input type="radio" name="duration" value="1" />Scene</td>
            </tr>
            <tr>
              <td>Distance</td>
              <td>
                <input
                  type="radio"
                  name="distance"
                  value="0"
                  checked="true"
                />Touch
              </td>
              <td>
                <input type="radio" name="distance" value="1" />Line of Sight
              </td>
            </tr>
            <tr>
              <td>Area of Effect</td>
              <td>
                <input type="radio" name="aoe" value="0" checked="true" />Arm's
                Length/One person
              </td>
              <td><input type="radio" name="aoe" value="1" />Room/~5 people</td>
            </tr>
            <tr>
              <td>Potency</td>
              <td>
                <input type="radio" name="potency" value="0" checked="true" />
                One Damage or One Dice Bonus or Penalty
              </td>
              <td>
                <input type="radio" name="potency" value="1" />Bypasses mundane
                protection
              </td>
            </tr>
          </table>
          Primary Spell Factor:

          <select id="psfactor">
            <option>Potency</option>
            <option>Duration</option>
            <option>Distance</option>
            <option>Area of Effect</option>
          </select>
          <p id="psf"></p>
          <p id="demo1" class="testing"><b>Total Reach: 0</b></p>
          <p id="demo2"><b>Over Reach: 0</b></p>
        </div>
      </div>
      </form>
        <div id="abilityColumn" class="column" style="display:block;">
          <h2 style="text-align: center"><span onclick="GimmeInfo('attributes')">Attributes</span></h2>
        <table>
          <th>PHYSICAL</th>
          <th>SOCIAL</th>
          <th>MENTAL</th>
        <tr>
          <td>
        <input type="number" min="1" max="5" value="1" class="attrib" id="strnum" style="display: none;" oninput="NumberMe('str')"><label><b>Strength</b></label><span style="white-space: nowrap" id="strPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="chanum" style="display: none;" oninput="NumberMe('cha')"><label><b>Charisma</b></label><span style="white-space: nowrap" id="chaPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="intnum" style="display: none;" oninput="NumberMe('int')"><label><b>Intelligence</b></label><span style="white-space: nowrap" id="intPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="dexnum" style="display: none;" oninput="NumberMe('dex')"><label><b>Dexterity</b></label><span style="white-space: nowrap" id="dexPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="mannum" style="display: none;" oninput="NumberMe('man')"><label><b>Manipulation</b></label><span style="white-space: nowrap" id="manPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="witnum" style="display: none;" oninput="NumberMe('wit')"><label><b>Wits</b></label><span style="white-space: nowrap" id="witPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="stanum" style="display: none;" oninput="NumberMe('sta')"><label><b>Stamina</b></label><span style="white-space: nowrap" id="staPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="comnum" style="display: none;" oninput="NumberMe('com')"><label><b>Composure</b></label><span style="white-space: nowrap" id="comPar">What?</span>
          </td>
          <td>
            <input type="number" min="1" max="5" value="1" class="attrib" id="resnum" style="display: none;" oninput="NumberMe('res')"><label><b>Resolve</b></label><span style="white-space: nowrap" id="resPar">What?</span>
          </td>
        </tr>
        </table>  
        <h2 style="text-align: center"><span onclick="GimmeInfo('skills')">Skills</span></h2>
        <table>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="athlnum" style="display: none;" oninput="NumberMe('athl')"><label><b>Athletics</b></label><span style="white-space: nowrap" id="athlPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="animnum" style="display: none;" oninput="NumberMe('anim')"><label><b>Animal Ken</b></label><span style="white-space: nowrap" id="animPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="acadnum" style="display: none;" oninput="NumberMe('acad')"><label><b>Academics</b></label><span style="white-space: nowrap" id="acadPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="brawnum" style="display: none;" oninput="NumberMe('braw')"><label><b>Brawl</b></label><span style="white-space: nowrap" id="brawPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="etiqnum" style="display: none;" oninput="NumberMe('etiq')"><label><b>Etiquette</b></label><span style="white-space: nowrap" id="etiqPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="awarnum" style="display: none;" oninput="NumberMe('awar')"><label><b>Awareness</b></label><span style="white-space: nowrap" id="awarPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="crafnum" style="display: none;" oninput="NumberMe('craf')"><label><b>Craft</b></label><span style="white-space: nowrap" id="crafPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="insinum" style="display: none;" oninput="NumberMe('insi')"><label><b>Insight</b></label><span style="white-space: nowrap" id="insiPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="finanum" style="display: none;" oninput="NumberMe('fina')"><label><b>Finance</b></label><span style="white-space: nowrap" id="finaPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="drivnum" style="display: none;" oninput="NumberMe('driv')"><label><b>Drive</b></label><span style="white-space: nowrap" id="drivPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="intinum" style="display: none;" oninput="NumberMe('inti')"><label><b>Intimidation</b></label><span style="white-space: nowrap" id="intiPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="invenum" style="display: none;" oninput="NumberMe('inve')"><label><b>Investigation</b></label><span style="white-space: nowrap" id="invePar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="firenum" style="display: none;" oninput="NumberMe('fire')"><label><b>Firearms</b></label><span style="white-space: nowrap" id="firePar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="leadnum" style="display: none;" oninput="NumberMe('lead')"><label><b>Leadership</b></label><span style="white-space: nowrap" id="leadPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="medinum" style="display: none;" oninput="NumberMe('medi')"><label><b>Medicine</b></label><span style="white-space: nowrap" id="mediPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="larcnum" style="display: none;" oninput="NumberMe('larc')"><label><b>Larceny</b></label><span style="white-space: nowrap" id="larcPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="perfnum" style="display: none;" oninput="NumberMe('perf')"><label><b>Performance</b></label><span style="white-space: nowrap" id="perfPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="occunum" style="display: none;" oninput="NumberMe('occu')"><label><b>Occult</b></label><span style="white-space: nowrap" id="occuPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="melenum" style="display: none;" oninput="NumberMe('mele')"><label><b>Melee</b></label><span style="white-space: nowrap" id="melePar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="persnum" style="display: none;" oninput="NumberMe('pers')"><label><b>Persuasion</b></label><span style="white-space: nowrap" id="persPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="polinum" style="display: none;" oninput="NumberMe('poli')"><label><b>Politics</b></label><span style="white-space: nowrap" id="poliPar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="steanum" style="display: none;" oninput="NumberMe('stea')"><label><b>Stealth</b></label><span style="white-space: nowrap" id="steaPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="strenum" style="display: none;" oninput="NumberMe('stre')"><label><b>Streetwise</b></label><span style="white-space: nowrap" id="strePar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="scienum" style="display: none;" oninput="NumberMe('scie')"><label><b>Science</b></label><span style="white-space: nowrap" id="sciePar">What?</span>
          </td>
        </tr>
        <tr>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="survnum" style="display: none;" oninput="NumberMe('surv')"><label><b>Survival</b></label><span style="white-space: nowrap" id="survPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="subtnum" style="display: none;" oninput="NumberMe('subt')"><label><b>Subterfuge</b></label><span style="white-space: nowrap" id="subtPar">What?</span>
          </td>
          <td>
            <input type="number" min="0" max="5" value="0" class="attrib" id="technum" style="display: none;" oninput="NumberMe('tech')"><label><b>Technology</b></label><span style="white-space: nowrap" id="techPar">What?</span>
          </td>
        </tr>
        </table>
        <p><b><span onclick="GimmeInfo('perception')">Perception</span></b>: Wits + Awareness</p> 
        <p><b><span onclick="GimmeInfo('initiative')">Intitiative</span></b>: Ongoing Melee, Ranged, New Melee, All Else</p>
        <p><b><span onclick="GimmeInfo('dodge')">Dodging</span></b>: Dexterity + Athletics</p>
        
        </div>
        <div class="column" >
          <p class="stat" name="clar">
            
            
            <input
              type="number"
              min="1"
              max="10"
              value="7"
              id="clarnum"
              class="attrib"
              oninput="MinMe('clar')"
            />
            <b><span onclick="GimmeInfo('clarity')">Clarity</span></b>
            <span id="clarPar">What?</span>
            <span class="tiny">Mark Stains</span>
          </p>
          <p class="stat" name="lim">
            <input
              type="number"
              min="0"
              max="5"
              value="0"
              id="limnum"
              class="attrib"
              oninput="NumberMe('lim')"
            />
            <b><span onclick="GimmeInfo('decoherence')">Decoherence</span></b>
            <span id="limPar">What?</span>
          </p>
          <p class="stat" name="wil">
            
            <b><span onclick="GimmeInfo('willpower')">Willpower</span></b>
            <span id="wilPar">What?</span>
            <input
              type="number"
              min="1"
              max="10"
              value="10"
              id="wilnum"
              class="attrib"
              oninput="MaxMe('wil')"
            />
            <span class="tiny">set max</span>
          </p>
          <p class="stat" name="heal">
            
            <b><span onclick="GimmeInfo('health')">Health</span></b>
            <span id="healPar">What?</span>
            <input
              type="number"
              min="1"
              max="10"
              value="10"
              id="healnum"
              class="attrib"
              oninput="MaxMe('heal')"
            />
            <span class="tiny">set max</span>
          </p>
          <h2>Roll Dice</h2>
          <form>
          Your Dice Pool:
          <select id="myPool">
            <option>1</option>
            <option>2</option>
            <option>3</option>
            <option>4</option>
            <option>5</option>
            <option>6</option>
            <option>7</option>
            <option>8</option>
            <option>9</option>
            <option>10</option>
          </select>
          <br />
          <p id="spelltotal" class="res"></p>
          <p id="spellresults" class="res"></p>
        </form>
          <br /><br />
        
        <input type="button" id="spell" value="Spell Roll" onclick="RollDice('spell')" />
        <input type="button" id="ability" value="Ability Check" onclick="RollDice('ability')" />
        <br />
        <p id="threemax"></p>
        <p id="demo"></p>

        <input type="button" id="rero" value="Willpower Reroll" />
      </div>
    </div>
    <div id="gonnahide" style="position:absolute;bottom:20px; right:100px;z-index:5; display:block;">
      <button onclick="ToggleBox('gonnahide', 'gonnareveal')">More info</button>
    </div>
    <div id="gonnareveal" style="position:absolute;bottom:20px; right:100px;z-index:5; display:none; width:40%; background-color:whitesmoke">
      <h3 style="text-align:right;">Info Box</h3>
      <p id="infoBox" style="
      padding: 10px">Click something to put info here</p>
      <button style="float:right;" onclick="ToggleBox('gonnareveal', 'gonnahide')">Close</button>
    </div>
    <input type="text" placeholder="copy the text here to save" id="saveField"><button onclick="LoadSave()">Load Save</button><input type="button" onclick="SavingStuff()" value="Save" />

    <script>
      var resultArray = [];
      var stats = ["gno", "arc", "lim", "spe", "str", "cha", "int", "dex", "man", "wit", "sta", "com", "res", "athl", "anim", "acad", "braw", "driv", "fire", "etiq", "awar", "craf", "insi", "fina", "inti", "inve", "lead", "medi", "larc", "perf", "occu", "mele", "pers", "poli", "stea", "stre", "scie", "surv", "subt", "tech"]
      var text1 = " ";
      var circle =
        "circle-empty.jpg";
      var filled =
        "circle-filled.jpg";
      var square =
        "square-empty.jpg";
      var squareSlash =
        "square-slash.jpg";
      var squareStar = 
        "square-star.jpg";
      var squareFilled = 
        "square-filled.jpg"
    
      

    function LoadSave() {
      let field = document.getElementById("saveField");
      let data = field.value;
      let array2 = data.split(",");
      let len = array2.length;
      let newArray2 = array2[0].split(":")
      for (let i = 0; i < len; i++) {
        pair = array2[i];
        newArray = pair.split(":");
        statId = newArray[0];
        statnum = newArray[1];
        statVal = Number(statnum);
        document.getElementById(statId).value = statVal;
        document.getElementById(statId).dispatchEvent(new Event("input"));
      }
      
    } 

    function SavingStuff() {
      let obj1 = document.getElementsByClassName("attrib");
      let array1 = [];
      let len = obj1.length;
      for (let i = 0; i < len; i++) {
        statName = obj1[i].id;
        statVal = obj1[i].value;
        statPair = statName+":" + statVal;
        array1.push(statPair);
      }
      document.getElementById("saveField").value = array1;
    }  
    
    function GettinValues(element) {
      let val = document.getElementById(element).value;
      return val;
    }
    
    function LoadThings() {
      BoxifyAll("heal");
      BoxifyAll("wil");
      ClarifyAll();
      let len = stats.length;
      for (let i = 0; i < len; i++) {
        sta = stats[i];
        DotifyAll(sta);
      }
      
    }

    function DotifyAll(attName) { 
      parId = attName + "Par";
      parPar = document.getElementById(parId);
      let text6 = " ";
      for (i = 1; i <= 5; i++) {
        if (attName == "spe") text6 +=
          "<input class='aCir' type='image' src='circle-empty.jpg' id='" +
          attName +
          i +
          "' onclick=\"ClickLim('" +
          attName +
          "', " +
          i +
          ')" />';
        else
        text6 +=
          "<input class='aCir' type='image' src='circle-empty.jpg' id='" +
          attName +
          i +
          "' onclick=\"ClickMe('" +
          attName +
          "', " +
          i +
          ')" />';
      }
      
      parPar.innerHTML = text6;
    }

    function BoxifyAll(attName) { 
      parId = attName + "Par";
      parPar = document.getElementById(parId);
      let text6 = " ";
      for (i = 1; i <= 10; i++) {
        text6 +=
          "<input class='aBox' type='image' alt='square' src='square-empty.jpg' id='" +
          attName +
          i +
          "' onclick=\"MarkMe('" +
          attName +
          "', " +
          i +
          ')" />';
      }
      
      parPar.innerHTML = text6;
    }

    function ClarifyAll() { 
      parPar = document.getElementById("clarPar");
      let text6 = " ";
      val = document.getElementById("clarnum").value;
      realVal = Number(val) + 1
      for (i = 1; i <= 10; i++) {
        if (i < realVal)
        text6 +=
          "<input class='aBox' type='image' alt='nope' src='square-filled.jpg' id='clar" +
          i +
          "' onclick=\"MarkMe('clar" +
          "', " +
          i +
          ')" />';
        else if (i < 11)
        text6 +=
          "<input class='aBox' type='image' alt='square' src='square-empty.jpg' id='clar" +
          i +
          "' onclick=\"MarkMe('clar" +
          "', " +
          i +
          ')" />';
      }  
      parPar.innerHTML = text6;
    }

    window.onload = function () {
        LoadThings();
      };

      function ToggleBox(hide, reveal) {
        let hidden = document.getElementById(hide);
        let revealed = document.getElementById(reveal);
        hidden.style["display"] = "none";
        revealed.style["display"] = "block";
        let spell = document.getElementById('spellTitle');
        let ability = document.getElementById('abilityTitle');
        if (hide == 'spellColumn') {
          spell.style["background-color"] = "whitesmoke";
          spell.style["color"] = "gray";
          spell.style["border-bottom"] = "1px";
          ability.style["background-color"] = "white";
          ability.style["color"] = "black";
          ability.style["border-bottom"] = "none";
        }
        else if (hide == 'abilityColumn') {
          spell.style["background-color"] = "white";
          spell.style["color"] = "black";
          spell.style["border-bottom"] = "none";
          ability.style["background-color"] = "whitesmoke";
          ability.style["color"] = "gray";
          ability.style["border-bottom"] = "1px";
        }
      }


      function ClickMe(stat, dot) {
        let dotId = stat + dot;
        let demog = document.getElementById(dotId);
        let numId = stat + "num";
        let dotFixed = Number(dot);
        let numStat = document.getElementById(numId);
        statMin = numStat.min;
        let currentVal = numStat.value;
        for (i = 1; i < 6; i++) {
          if (statMin == 1 || currentVal != 1 || dotFixed != 1) {
          numStat.value = dotFixed;
          let newImg = stat + i;
          if (i > dotFixed) document.getElementById(newImg).src = circle;
          else if (i <= dotFixed) document.getElementById(newImg).src = filled;
        } else  {
          numStat.value = 0;
          let newImg = stat + i;
          document.getElementById(newImg).src = circle;
        }
        }
      }

      function MarkMe(stat, box) {
        let numBox = Number(box)
        let boxId = stat + numBox;
        if (box > 1) {
        numLeft = numBox - 1;
        idLeft = stat + numLeft;
        boxLeft = document.getElementById(idLeft);
        }
        if (box < 10) {
        numRight = numBox + 1;
        idRight = stat + numRight;
        boxRight = document.getElementById(idRight);
        }
        let mainBox = document.getElementById(boxId);
        if (box == 10 || boxRight.alt == "square" || boxRight.alt == "nope") {
        if (box == 1 || boxLeft.alt != "square" || boxLeft.alt == "nope") {
        if (mainBox.alt == "square") {
          mainBox.src = squareSlash; 
          mainBox.alt = "slash";
        }
        else if (mainBox.alt == "slash") {
          if (box == 1 || boxLeft.alt == "star" || boxLeft.alt == "nope") {
          mainBox.src = squareStar;
          mainBox.alt = "star"
        } else {
          mainBox.src = square;
          mainBox.alt = "square"
        }
        }
        else if (mainBox.alt == "star") {
          mainBox.src = square;
          mainBox.alt = "square"
        }
      }
      }
      else if (boxRight.alt == "slash" && mainBox.alt == "slash") {
        if (box == 1 || boxLeft.alt == "star" || boxLeft.alt == "nope") {
          mainBox.src = squareStar;
          mainBox.alt = "star"
        }
      }
      }

      function MaxMe(stat) {
        let numId = stat + "num";
        let val = document.getElementById(numId).value;
        let boxId = stat + val;
        let altText = document.getElementById(boxId).alt;
        for (i = val; i < 11; i++) {
          newImg = stat + i;
          if (i > val) {
            document.getElementById(newImg).src = squareFilled;
            document.getElementById(newImg).alt = "nope";
          }
          else if (i = val) {
            if (altText == "nope" || altText == "square") {
            document.getElementById(newImg).src = square;
            document.getElementById(newImg).alt = "square";
          } else if (altText == "slash") {
            document.getElementById(newImg).src = squareSlash;
            document.getElementById(newImg).alt = "slash";
          } else if (altText == "star") {
            document.getElementById(newImg).src = squareStar;
            document.getElementById(newImg).alt = "star";
          }
          }
        }
      }

      function MinMe(stat) {
        let numId = stat + "num";
        let val = document.getElementById(numId).value;
        for (i = 1; i < 11; i++) {
          newImg = stat + i;
          if (i <= val) {
            document.getElementById(newImg).src = squareFilled;
            document.getElementById(newImg).alt = "nope";
          }
          else if (i > val) {
            document.getElementById(newImg).src = square;
            document.getElementById(newImg).alt = "square";
          }
        }
      }

      function ClickLim(stat, dot) {
        let dotId = stat + dot;
        let demog = document.getElementById(dotId);
        let num = stat + "num";
        let arcLvl = document.getElementById("arcnum").value;
        dot = Number(dot);
        if (arcLvl >= dot) {
          document.getElementById(num).value = dot;
          for (i = 1; i < 6; i++) {
            newImg = stat + i;
            if (i > dot) document.getElementById(newImg).src = circle;
            else if (i <= dot) document.getElementById(newImg).src = filled;
          }
        }
      }



      function NumberMe(stat) {
        let numId = stat + "num";
        let val = document.getElementById(numId).value;
        ClickMe(stat, val);
      }

      function UpdateReach() {
        let element = document.getElementById("demo1");
        casting = Number(CheckValue("castingtime"));
        duration = Number(CheckValue("duration"));
        distance = Number(CheckValue("distance"));
        aoe = Number(CheckValue("aoe"));
        potency = Number(CheckValue("potency"));
        totalreach = casting + duration + distance + aoe + potency;
        return totalreach;
      }

      function UpdateText() {
        const obj2 = document.getElementById("demo1");
        const obj3 = document.getElementById("demo2");
        var totalreach = UpdateReach();
        var overreach = OverReach();
        obj2.innerHTML = "<b>Total Reach: </b>" + totalreach;
        if (overreach > 0) {
          obj3.innerHTML =
            "<b><FONT COLOR=red>Over Reach: </b>" +
            overreach +
            "<br>Warning: Successes are automatically applied to Over Reach <br> &nbsp&nbsp If there are insufficient succcesses, an Anomaly might occur";
        } else if (overreach <= 0) {
          obj3.innerHTML = "<b><FONT COLOR=black>Over Reach: </b>" + overreach;
        }
      }

      function OverReach() {
        var arcLvl = document.getElementById("arcnum").value;
        var spellLvl = document.getElementById("spenum").value;
        availReach = arcLvl - spellLvl + 1;
        var totalReach = UpdateReach();
        let overReach = totalReach - availReach;
        if (overReach > 0) return overReach;
        else return 0;
      }

      document.addEventListener("input", UpdateText);
      document.addEventListener("input", FactorAlert);
      document.addEventListener("click", FreeReach);

      function FreeReach() {
        var arcVal = document.getElementById("arcnum").value;
        var spell = document.getElementById("spenum");
        spell.max = arcVal;
        parId = document.getElementById("freeReach");
        freeR = 1 + Number(arcVal) - Number(spell.value);
        parId.innerHTML = "Free Reach: " + freeR;
      }

      function FactorAlert() {
        let parid = document.getElementById("psf");
        let obj = document.getElementById("psfactor");
        let psf = obj.options[obj.selectedIndex].text;
        if (psf == "Potency")
          parid.innerHTML =
            "<FONT COLOR=blue>Each success will grant +1 damage, bonus dice, or penalty dice";
        else if (psf == "Duration")
          parid.innerHTML =
            "<FONT COLOR=blue>Spell lasts for as many turns as successes";
        else if (psf == "Distance")
          parid.innerHTML =
            "<FONT COLOR=blue>Spell can be cast on a target at the distance of 5ft x the number of successes";
        else if (psf == "Area of Effect")
          parid.innerHTML =
            "<FONT COLOR=blue>Spell effects an area of a radius 5ft x # of success or number of people equal to successes";
      }


      function CheckValue(radioname) {
        var obj1 = document.getElementsByName(radioname);
        for (i = 0; i < obj1.length; i++) {
          if (obj1[i].checked) return obj1[i].value;
        }
      }


      function RollDice(rollType) {
        rt = rollType;
        resultArray = [];
        var liminality = document.getElementById("limnum").value;
        let obj = document.getElementById("myPool");
        let pool = Number(obj.options[obj.selectedIndex].text);
        while (pool > 0) {
          roll = Math.floor(Math.random() * 10) + 1;
          if (roll > 9) {
            pool--;
            result = { dieRoll: roll, status: "Critical Success" };
            resultArray.push(result);
          } else if (roll > 5) {
            pool--;
            result = { dieRoll: roll, status: "Success" };
            resultArray.push(result);
          } else if (roll > 1) {
            pool--;
            result = { dieRoll: roll, status: "Failure" };
            resultArray.push(result);
          } else if (roll > 0) {
            pool--;
            result = { dieRoll: roll, status: "Critical Failure" };
            resultArray.push(result);
          }
        }
        PrintResults(resultArray, rollType);
      }

      function PrintResults(resultArray, rollType) {
        var liminality = document.getElementById("limnum").value;
        let overreach = OverReach();
        let rLen = resultArray.length;
        let succ = 0;
        let critSuc = 0
        let critFail = 0
        let lim = liminality - 1;
        let text1 = "<ul> ";
        let st = document.getElementById("spelltotal");    
        let sr = document.getElementById("spellresults");
        st.innerHTML = " ";
        sr.innerHTML = " ";      
        for (let i = 0; i < rLen; i++) {
          if (i <= lim) {
            text1 += "<li><FONT COLOR=purple>";
            if (resultArray[i].dieRoll > 9) critSuc++;
            else if (resultArray[i].dieRoll == 1) critFail++;
          }
          else if (i > lim) text1 += "<li><FONT COLOR=black> ";
          text1 +=
            resultArray[i].status + " " + resultArray[i].dieRoll + "</li>";
          if (resultArray[i].dieRoll > 9) {
            succ++;
            succ++;
          } else if (resultArray[i].dieRoll > 5) succ++;
          else if (resultArray[i].dieRoll == 1) succ--;
        }
        if (rollType == "ability") {
          crits = critSuc + critFail;
          if (crits > 0) sr.innerHTML = "<FONT-COLOR=red><b>Arcana Bleed: " + crits + "</b><br /><FONT-COLOR=black>";
          st.innerHTML  = "<b> Total Successes: " + succ + "</b></ul>";
          document
          .getElementById("rero")
          .setAttribute("onclick", "SetupReroll(resultArray, 'ability')");
        }
        else if (rollType == "spell") {
          total = succ - overreach;
        if (total > 0) {
          if (critSuc > 0) sr.innerHTML = "<b>Spell Surge: " + critSuc + "</b><br />";
          st.innerHTML = "<b> Total Successes: " + total + "</b></ul>";
        } else if (total == 0 && critFail < 1) { st.innerHTML = "No Successes <br />The spell is not forming as you'd hope.<br />You can strain local reality to force 1 Success.";
        } else if (total <= 0) {
          anomaly = overreach - succ;
          sr.innerHTML = "<b>Possible Reality Tear <b>";
          if (critFail > 0) sr.innerHTML =
            "<FONT COLOR=purple><h2>You have triggered an Anomaly<h2> ";
              st.innerHTML = " Total Successes: -" + anomaly + "</ul>";
        }
        document
          .getElementById("rero")
          .setAttribute("onclick", "SetupReroll(resultArray, 'spell')");
        }
        document.getElementById("demo").innerHTML = text1;
      }

      function SetupReroll(resultArray, rollType) {
        var liminality = document.getElementById("limnum").value;
        let rLen = resultArray.length;
        let succ = 0;
        let lim = liminality - 1;
        let text1 =
          "<ul><br /><form method='post' name='will_form' id='will_form'>";
        
        if (rollType == "ability") {
        for (let i = 0; i < rLen; i++) {
          if (i <= lim)
            text1 +=
              "<li><FONT COLOR=gray><strike> <input type='checkbox' name='check[]' value='Check Box " +
              i +
              "' onclick='return false'/>";
          else if (i > lim)
            text1 +=
              "<li><FONT COLOR=black> <input type='checkbox' name='check[]' value='Check Box " +
              i +
              "' onclick=checkBoxLimit('ability') />";
          text1 +=
            "<label id=result" +
            i +
            "> " +
            resultArray[i].status +
            " " +
            resultArray[i].dieRoll +
            "</label></li></strike>";
        }
        }
        else if (rollType == "spell") {
        for (let i = 0; i < rLen; i++) {
          if (i <= lim)
            text1 +=
            "<li><FONT COLOR=purple> <input type='checkbox' name='check[]' value='Check Box " +
              i +
              "' onclick=checkBoxLimit('spell') />";
          else if (i > lim)
            text1 +=
            "<li><FONT COLOR=gray><strike> <input type='checkbox' name='check[]' value='Check Box " +
              i +
              "' onclick='return false'/>";       
          text1 +=
            "<label id=result" +
            i +
            "> " +
            resultArray[i].status +
            " " +
            resultArray[i].dieRoll +
            "</label></li></strike>";
        }
        }
        document.getElementById("demo").innerHTML = text1;
        document.getElementById("rero").setAttribute("value", "Reroll Now");
      }

      function checkBoxLimit(rollType) {
        var checkBoxGroup = document.forms["will_form"]["check[]"];
        var limit = 3;
        if (rollType == "spell") {
          document
          .getElementById("rero")
          .setAttribute("onclick", "ActualReroll('spell')");
        }
        else if (rollType == "ability") {
          document
          .getElementById("rero")
          .setAttribute("onclick", "ActualReroll('ability')");
        }
        for (var i = 0; i < checkBoxGroup.length; i++) {
          checkBoxGroup[i].onclick = function () {
            var checkedcount = 0;
            for (var i = 0; i < checkBoxGroup.length; i++) {
              checkedcount += checkBoxGroup[i].checked ? 1 : 0;
            }
            if (checkedcount > limit) {
              document.getElementById("threemax").innerHTML =
                "<FONT COLOR=red>You can only select 3 boxes";
              this.checked = false;
            }
          };
        }
      }

      function ActualReroll(rollType) {
        var checkBoxGroup = document.forms["will_form"]["check[]"];
        let rero = document.getElementById("rero")
        rero.value = "Willpower Reroll";
        document.getElementById("threemax").innerHTML = " ";
        for (var i = 0; i < checkBoxGroup.length; i++) {
          resLabel = "result" + i;
          findit = document.getElementById(resLabel);
          if (checkBoxGroup[i].checked) {
            newroll = Math.floor(Math.random() * 10) + 1;
            resultArray[i].dieRoll = newroll;
            if (newroll > 9) resultArray[i].status = "Critical Success";
            else if (newroll > 5) resultArray[i].status = "Success";
            else if (newroll > 1) resultArray[i].status = "Failure";
            else if (newroll > 0) resultArray[i].status = "Critical Failure";
            PrintResults(resultArray, rollType);
          }
        }
      }

      function GimmeInfo(subject) {
      let parId = document.getElementById("infoBox");
      if (subject == "willpower")
        parId.innerHTML ="<b>Willpower:</b> Equal to Resolve+Composure. At the start of each game, you get back points equal to the higher of the two.<br />You can use a WP point to reroll up to 3 dice. However, for Spell Rolls you can only reroll Decoherence dice, and for Ability Rolls you can only reroll NON-Decoherence dice.<br />If you spend your last WP, you have -2 to all rolls. ";
      else if (subject == "gnosis")
        parId.innerHTML ="<b>Gnosis:</b> VtM Equivalent: Blood Potency.<br />Added to all Spell Rolls (along with the relevant Arcana Level), this measures your overall strength as a mage and your ability to interact with the supernatural<br />As your Gnosis increases, you may find it harder to satisfy your obsession.";
      else if (subject == "arcana")
        parId.innerHTML ="<b>Arcana Level:</b> Your overall ability to manipulate a specific element of reality. The 9 Arcana are split into 3 broader spheres of influence:<br /> Physical (Matter, Forces, Space), Vital (Mind, Life, Prime), and Eventual (Fate, Time, Death). How you can affect an Arcana is determined by the Spell Level.";
      else if (subject == "spell")
        parId.innerHTML ="<b>Spell Level:</b><br />One Dot: Gain Knowledge, Reveal something hidden, Make something happen that is likely to happen.<br />Two Dots: Protection, Hiding Something, Make something happen that is very unlikely but possible. Add dice to a roll.<br />Three Dots: Do Bashing damage. Heal Bashing damage. Make something happen that is normally impossible without mundane intervention. Add to/Subtract from a Stat.<br />Four Dots: Make something impossible happen. Change a property of something to a different but related property.<br />Five Dots: Make something new or delete something from existence."; 
      else if (subject == "reach")
        parId.innerHTML ="<b>Reach:</b> This is your ability to push a spell beyond its normal limits. You get 1 free reach plus the difference between the Arcana Level and the Spell Level.<br />You can push beyond this, creating Overreach. Overreach is subtracted from your successes. If you dont have enough successes, an anomaly might occur.";
      else if (subject == "decoherence")
        parId.innerHTML ="<b>Decoherence:</b> VtM equivalent to Hunger<br />Your decoherence builds as you strain the line between the Sleeping World and the Real World. Decoherence allows you to reroll spell dice, but you cannot reroll Decoherence dice during ability rolls.<br />How you lower decoherence depends on your Obsession. If it rises while you are at 5, you gain a stain to your Clarity.";
      else if (subject == "health")
        parId.innerHTML ="<b>Health:</b> Your Health is equal to Stamina+Size (5). There are two types of damage, Bashing (indicated by a single slash)and Aggravated (three slashes). Place them left to right, with more serious damage farthest left. If your health track is full, roll Stamina each round to stay conscious.<br />Healing: Bashing damage heals one point per hour and Aggravated heals one point per 3 days. Some 2 dot spells can reduce this time, some 3 dot spells can heal Bashing, and 4 dot spells can heal Aggravated.";
      else if (subject == "clarity")
        parId.innerHTML ="<b>Clarity:</b> VtM equivalent to Humanity<br />Your Clarity is your overall grasp of the Sleeping world, how it feels for those who are still asleep, and your connection to the rest of humanity. As a mage's clarity declines, they often find it harder to interact with sleepers and the mundane world.<br />Severe aggressions against reality and sleeping humans will stain your clarity. Mark the empty remaining boxes on your clarity track. At the end of each session, you will roll dice equal to the unmarked boxes.<br />Any success allows you to maintain your Clarity. Fail the roll and your Clarity declines as the Sleeping world fades from your understanding.";
      else if (subject == "attributes")
        parId.innerHTML ="<b>Attributes:</b> These are your 9 Attributes. The Top row are your Power stats, the middle row are your Finesse stats, and the bottom row are your Resistance stats. Your Health is determined by your Stamina + Size (5). Your Willpower is Resolve + Composure.<br />Most ability rolls will be an Attribute + a skill (eg. Wits + Awareness for perception, Hand-to-hand combat is Strength + Brawl, Melee weapons are Dexterity + Melee, and Firearms are usually Composure + Firearms.), but some will be two Attributes (eg. Resolve + Composure).<br />In character creation, each stat starts with one Dot. You then can assign 5 dots, 4 dots, and 3 dots each to a column as you see fit. You then add one additional dot to one Resistance stat (ie the bottom row)";
      else if (subject == "skills")
        parId.innerHTML ="<b>Skills:</b> These will always be paired with an Attribute for dice rolls. For character creation, you have 3 options:<br />-Jack of All Trades: One skill at 3 dots, eight skills at 2, ten skills at 1<br />-Balanced: Three at 3 dots, five at 2, seven at 1<br />-Specialist:One skill at 4, Three at 3, Three at 1.<br />Additionally, if you have at least one dot in Academics, Craft, Performance, and/or Science, you gain a free Specialty. You add one additional dice to a roll when the Specialty is relevant.";
      }
    </script>
  </body>
</html>
